-- Graph-Constrained Secant Variety
-- Tensor Shape: [4, 4, 4], CP Rank: 3

kk = ZZ/32003
R = kk[v_(0,0,0), v_(0,0,1), v_(0,0,2), v_(0,1,0), v_(0,1,1), v_(0,1,2), v_(0,2,0), v_(0,2,1), v_(0,2,2), v_(0,3,0), v_(0,3,1), v_(0,3,2), v_(1,0,0), v_(1,0,1), v_(1,0,2), v_(1,1,0), v_(1,1,1), v_(1,1,2), v_(1,2,0), v_(1,2,1), v_(1,2,2), v_(1,3,0), v_(1,3,1), v_(1,3,2), v_(2,0,2), v_(2,1,2), v_(2,2,0), v_(2,2,1), v_(2,2,2), v_(2,3,0), v_(2,3,1), v_(2,3,2)]

-- The CP Parameterization Map
F = matrix{{ v_(0,0,2)*v_(1,0,2)*v_(2,0,2), v_(0,0,2)*v_(1,0,2)*v_(2,1,2), v_(0,0,0)*v_(1,0,0)*v_(2,2,0) + v_(0,0,1)*v_(1,0,1)*v_(2,2,1) + v_(0,0,2)*v_(1,0,2)*v_(2,2,2), v_(0,0,0)*v_(1,0,0)*v_(2,3,0) + v_(0,0,1)*v_(1,0,1)*v_(2,3,1) + v_(0,0,2)*v_(1,0,2)*v_(2,3,2), v_(0,0,2)*v_(1,1,2)*v_(2,0,2), v_(0,0,2)*v_(1,1,2)*v_(2,1,2), v_(0,0,0)*v_(1,1,0)*v_(2,2,0) + v_(0,0,1)*v_(1,1,1)*v_(2,2,1) + v_(0,0,2)*v_(1,1,2)*v_(2,2,2), v_(0,0,0)*v_(1,1,0)*v_(2,3,0) + v_(0,0,1)*v_(1,1,1)*v_(2,3,1) + v_(0,0,2)*v_(1,1,2)*v_(2,3,2), v_(0,0,2)*v_(1,2,2)*v_(2,0,2), v_(0,0,2)*v_(1,2,2)*v_(2,1,2), v_(0,0,0)*v_(1,2,0)*v_(2,2,0) + v_(0,0,1)*v_(1,2,1)*v_(2,2,1) + v_(0,0,2)*v_(1,2,2)*v_(2,2,2), v_(0,0,0)*v_(1,2,0)*v_(2,3,0) + v_(0,0,1)*v_(1,2,1)*v_(2,3,1) + v_(0,0,2)*v_(1,2,2)*v_(2,3,2), v_(0,0,2)*v_(1,3,2)*v_(2,0,2), v_(0,0,2)*v_(1,3,2)*v_(2,1,2), v_(0,0,0)*v_(1,3,0)*v_(2,2,0) + v_(0,0,1)*v_(1,3,1)*v_(2,2,1) + v_(0,0,2)*v_(1,3,2)*v_(2,2,2), v_(0,0,0)*v_(1,3,0)*v_(2,3,0) + v_(0,0,1)*v_(1,3,1)*v_(2,3,1) + v_(0,0,2)*v_(1,3,2)*v_(2,3,2), v_(0,1,2)*v_(1,0,2)*v_(2,0,2), v_(0,1,2)*v_(1,0,2)*v_(2,1,2), v_(0,1,0)*v_(1,0,0)*v_(2,2,0) + v_(0,1,1)*v_(1,0,1)*v_(2,2,1) + v_(0,1,2)*v_(1,0,2)*v_(2,2,2), v_(0,1,0)*v_(1,0,0)*v_(2,3,0) + v_(0,1,1)*v_(1,0,1)*v_(2,3,1) + v_(0,1,2)*v_(1,0,2)*v_(2,3,2), v_(0,1,2)*v_(1,1,2)*v_(2,0,2), v_(0,1,2)*v_(1,1,2)*v_(2,1,2), v_(0,1,0)*v_(1,1,0)*v_(2,2,0) + v_(0,1,1)*v_(1,1,1)*v_(2,2,1) + v_(0,1,2)*v_(1,1,2)*v_(2,2,2), v_(0,1,0)*v_(1,1,0)*v_(2,3,0) + v_(0,1,1)*v_(1,1,1)*v_(2,3,1) + v_(0,1,2)*v_(1,1,2)*v_(2,3,2), v_(0,1,2)*v_(1,2,2)*v_(2,0,2), v_(0,1,2)*v_(1,2,2)*v_(2,1,2), v_(0,1,0)*v_(1,2,0)*v_(2,2,0) + v_(0,1,1)*v_(1,2,1)*v_(2,2,1) + v_(0,1,2)*v_(1,2,2)*v_(2,2,2), v_(0,1,0)*v_(1,2,0)*v_(2,3,0) + v_(0,1,1)*v_(1,2,1)*v_(2,3,1) + v_(0,1,2)*v_(1,2,2)*v_(2,3,2), v_(0,1,2)*v_(1,3,2)*v_(2,0,2), v_(0,1,2)*v_(1,3,2)*v_(2,1,2), v_(0,1,0)*v_(1,3,0)*v_(2,2,0) + v_(0,1,1)*v_(1,3,1)*v_(2,2,1) + v_(0,1,2)*v_(1,3,2)*v_(2,2,2), v_(0,1,0)*v_(1,3,0)*v_(2,3,0) + v_(0,1,1)*v_(1,3,1)*v_(2,3,1) + v_(0,1,2)*v_(1,3,2)*v_(2,3,2), v_(0,2,2)*v_(1,0,2)*v_(2,0,2), v_(0,2,2)*v_(1,0,2)*v_(2,1,2), v_(0,2,0)*v_(1,0,0)*v_(2,2,0) + v_(0,2,1)*v_(1,0,1)*v_(2,2,1) + v_(0,2,2)*v_(1,0,2)*v_(2,2,2), v_(0,2,0)*v_(1,0,0)*v_(2,3,0) + v_(0,2,1)*v_(1,0,1)*v_(2,3,1) + v_(0,2,2)*v_(1,0,2)*v_(2,3,2), v_(0,2,2)*v_(1,1,2)*v_(2,0,2), v_(0,2,2)*v_(1,1,2)*v_(2,1,2), v_(0,2,0)*v_(1,1,0)*v_(2,2,0) + v_(0,2,1)*v_(1,1,1)*v_(2,2,1) + v_(0,2,2)*v_(1,1,2)*v_(2,2,2), v_(0,2,0)*v_(1,1,0)*v_(2,3,0) + v_(0,2,1)*v_(1,1,1)*v_(2,3,1) + v_(0,2,2)*v_(1,1,2)*v_(2,3,2), v_(0,2,2)*v_(1,2,2)*v_(2,0,2), v_(0,2,2)*v_(1,2,2)*v_(2,1,2), v_(0,2,0)*v_(1,2,0)*v_(2,2,0) + v_(0,2,1)*v_(1,2,1)*v_(2,2,1) + v_(0,2,2)*v_(1,2,2)*v_(2,2,2), v_(0,2,0)*v_(1,2,0)*v_(2,3,0) + v_(0,2,1)*v_(1,2,1)*v_(2,3,1) + v_(0,2,2)*v_(1,2,2)*v_(2,3,2), v_(0,2,2)*v_(1,3,2)*v_(2,0,2), v_(0,2,2)*v_(1,3,2)*v_(2,1,2), v_(0,2,0)*v_(1,3,0)*v_(2,2,0) + v_(0,2,1)*v_(1,3,1)*v_(2,2,1) + v_(0,2,2)*v_(1,3,2)*v_(2,2,2), v_(0,2,0)*v_(1,3,0)*v_(2,3,0) + v_(0,2,1)*v_(1,3,1)*v_(2,3,1) + v_(0,2,2)*v_(1,3,2)*v_(2,3,2), v_(0,3,2)*v_(1,0,2)*v_(2,0,2), v_(0,3,2)*v_(1,0,2)*v_(2,1,2), v_(0,3,0)*v_(1,0,0)*v_(2,2,0) + v_(0,3,1)*v_(1,0,1)*v_(2,2,1) + v_(0,3,2)*v_(1,0,2)*v_(2,2,2), v_(0,3,0)*v_(1,0,0)*v_(2,3,0) + v_(0,3,1)*v_(1,0,1)*v_(2,3,1) + v_(0,3,2)*v_(1,0,2)*v_(2,3,2), v_(0,3,2)*v_(1,1,2)*v_(2,0,2), v_(0,3,2)*v_(1,1,2)*v_(2,1,2), v_(0,3,0)*v_(1,1,0)*v_(2,2,0) + v_(0,3,1)*v_(1,1,1)*v_(2,2,1) + v_(0,3,2)*v_(1,1,2)*v_(2,2,2), v_(0,3,0)*v_(1,1,0)*v_(2,3,0) + v_(0,3,1)*v_(1,1,1)*v_(2,3,1) + v_(0,3,2)*v_(1,1,2)*v_(2,3,2), v_(0,3,2)*v_(1,2,2)*v_(2,0,2), v_(0,3,2)*v_(1,2,2)*v_(2,1,2), v_(0,3,0)*v_(1,2,0)*v_(2,2,0) + v_(0,3,1)*v_(1,2,1)*v_(2,2,1) + v_(0,3,2)*v_(1,2,2)*v_(2,2,2), v_(0,3,0)*v_(1,2,0)*v_(2,3,0) + v_(0,3,1)*v_(1,2,1)*v_(2,3,1) + v_(0,3,2)*v_(1,2,2)*v_(2,3,2), v_(0,3,2)*v_(1,3,2)*v_(2,0,2), v_(0,3,2)*v_(1,3,2)*v_(2,1,2), v_(0,3,0)*v_(1,3,0)*v_(2,2,0) + v_(0,3,1)*v_(1,3,1)*v_(2,2,1) + v_(0,3,2)*v_(1,3,2)*v_(2,2,2), v_(0,3,0)*v_(1,3,0)*v_(2,3,0) + v_(0,3,1)*v_(1,3,1)*v_(2,3,1) + v_(0,3,2)*v_(1,3,2)*v_(2,3,2) }}

-- Compute the symbolic Jacobian
J = jacobian F

-- Evaluate the Jacobian at a random numerical point
randomVals = apply(gens R, v -> v => random kk)
J_eval = sub(J, randomVals)

print "--- Geometric Identifiability Report ---"
print "Total Free Parameters (Vertices): 32"
print "Scaling Redundancies: 6"
print "Expected Dimension (if identifiable): 26"
print ""
print "Actual Dimension of Constrained Variety (Jacobian Rank):"
print rank J_eval
