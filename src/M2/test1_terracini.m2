-- Graph-Constrained Secant Variety
-- Tensor Shape: [3, 3, 3], CP Rank: 2

kk = ZZ/32003
R = kk[v_(0,0,0), v_(0,0,1), v_(0,1,0), v_(0,1,1), v_(0,2,0), v_(0,2,1), v_(1,0,0), v_(1,0,1), v_(1,1,0), v_(1,1,1), v_(1,2,0), v_(1,2,1), v_(2,0,1), v_(2,1,0), v_(2,1,1), v_(2,2,0), v_(2,2,1)]

-- The CP Parameterization Map
F = matrix{{ v_(0,0,1)*v_(1,0,1)*v_(2,0,1), v_(0,0,0)*v_(1,0,0)*v_(2,1,0) + v_(0,0,1)*v_(1,0,1)*v_(2,1,1), v_(0,0,0)*v_(1,0,0)*v_(2,2,0) + v_(0,0,1)*v_(1,0,1)*v_(2,2,1), v_(0,0,1)*v_(1,1,1)*v_(2,0,1), v_(0,0,0)*v_(1,1,0)*v_(2,1,0) + v_(0,0,1)*v_(1,1,1)*v_(2,1,1), v_(0,0,0)*v_(1,1,0)*v_(2,2,0) + v_(0,0,1)*v_(1,1,1)*v_(2,2,1), v_(0,0,1)*v_(1,2,1)*v_(2,0,1), v_(0,0,0)*v_(1,2,0)*v_(2,1,0) + v_(0,0,1)*v_(1,2,1)*v_(2,1,1), v_(0,0,0)*v_(1,2,0)*v_(2,2,0) + v_(0,0,1)*v_(1,2,1)*v_(2,2,1), v_(0,1,1)*v_(1,0,1)*v_(2,0,1), v_(0,1,0)*v_(1,0,0)*v_(2,1,0) + v_(0,1,1)*v_(1,0,1)*v_(2,1,1), v_(0,1,0)*v_(1,0,0)*v_(2,2,0) + v_(0,1,1)*v_(1,0,1)*v_(2,2,1), v_(0,1,1)*v_(1,1,1)*v_(2,0,1), v_(0,1,0)*v_(1,1,0)*v_(2,1,0) + v_(0,1,1)*v_(1,1,1)*v_(2,1,1), v_(0,1,0)*v_(1,1,0)*v_(2,2,0) + v_(0,1,1)*v_(1,1,1)*v_(2,2,1), v_(0,1,1)*v_(1,2,1)*v_(2,0,1), v_(0,1,0)*v_(1,2,0)*v_(2,1,0) + v_(0,1,1)*v_(1,2,1)*v_(2,1,1), v_(0,1,0)*v_(1,2,0)*v_(2,2,0) + v_(0,1,1)*v_(1,2,1)*v_(2,2,1), v_(0,2,1)*v_(1,0,1)*v_(2,0,1), v_(0,2,0)*v_(1,0,0)*v_(2,1,0) + v_(0,2,1)*v_(1,0,1)*v_(2,1,1), v_(0,2,0)*v_(1,0,0)*v_(2,2,0) + v_(0,2,1)*v_(1,0,1)*v_(2,2,1), v_(0,2,1)*v_(1,1,1)*v_(2,0,1), v_(0,2,0)*v_(1,1,0)*v_(2,1,0) + v_(0,2,1)*v_(1,1,1)*v_(2,1,1), v_(0,2,0)*v_(1,1,0)*v_(2,2,0) + v_(0,2,1)*v_(1,1,1)*v_(2,2,1), v_(0,2,1)*v_(1,2,1)*v_(2,0,1), v_(0,2,0)*v_(1,2,0)*v_(2,1,0) + v_(0,2,1)*v_(1,2,1)*v_(2,1,1), v_(0,2,0)*v_(1,2,0)*v_(2,2,0) + v_(0,2,1)*v_(1,2,1)*v_(2,2,1) }}

-- Compute the symbolic Jacobian
J = jacobian F

-- Evaluate the Jacobian at a random numerical point
randomVals = apply(gens R, v -> v => random kk)
J_eval = sub(J, randomVals)

print "--- Geometric Identifiability Report ---"
print "Total Free Parameters (Vertices): 17"
print "Scaling Redundancies: 4"
print "Expected Dimension (if identifiable): 13"
print ""
print "Actual Dimension of Constrained Variety (Jacobian Rank):"
print rank J_eval
