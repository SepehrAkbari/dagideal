-- Graph-Constrained Secant Variety
-- Tensor Shape: [4, 4, 4], CP Rank: 3

kk = ZZ/32003
R = kk[v_(0,0,0), v_(0,0,1), v_(0,0,2), v_(0,1,0), v_(0,1,1), v_(0,1,2), v_(0,2,0), v_(0,2,1), v_(0,2,2), v_(0,3,0), v_(0,3,1), v_(0,3,2), v_(1,0,0), v_(1,0,1), v_(1,0,2), v_(1,1,0), v_(1,1,1), v_(1,1,2), v_(1,2,0), v_(1,2,1), v_(1,2,2), v_(1,3,0), v_(1,3,1), v_(1,3,2), v_(2,0,2), v_(2,1,2), v_(2,2,0), v_(2,2,1), v_(2,2,2), v_(2,3,0), v_(2,3,1), v_(2,3,2), t_(0,0,0), t_(0,0,1), t_(0,0,2), t_(0,0,3), t_(0,1,0), t_(0,1,1), t_(0,1,2), t_(0,1,3), t_(0,2,0), t_(0,2,1), t_(0,2,2), t_(0,2,3), t_(0,3,0), t_(0,3,1), t_(0,3,2), t_(0,3,3), t_(1,0,0), t_(1,0,1), t_(1,0,2), t_(1,0,3), t_(1,1,0), t_(1,1,1), t_(1,1,2), t_(1,1,3), t_(1,2,0), t_(1,2,1), t_(1,2,2), t_(1,2,3), t_(1,3,0), t_(1,3,1), t_(1,3,2), t_(1,3,3), t_(2,0,0), t_(2,0,1), t_(2,0,2), t_(2,0,3), t_(2,1,0), t_(2,1,1), t_(2,1,2), t_(2,1,3), t_(2,2,0), t_(2,2,1), t_(2,2,2), t_(2,2,3), t_(2,3,0), t_(2,3,1), t_(2,3,2), t_(2,3,3), t_(3,0,0), t_(3,0,1), t_(3,0,2), t_(3,0,3), t_(3,1,0), t_(3,1,1), t_(3,1,2), t_(3,1,3), t_(3,2,0), t_(3,2,1), t_(3,2,2), t_(3,2,3), t_(3,3,0), t_(3,3,1), t_(3,3,2), t_(3,3,3)]

I_cp = ideal(
    t_(0,0,0) - (v_(0,0,2)*v_(1,0,2)*v_(2,0,2)),
    t_(0,0,1) - (v_(0,0,2)*v_(1,0,2)*v_(2,1,2)),
    t_(0,0,2) - (v_(0,0,0)*v_(1,0,0)*v_(2,2,0) + v_(0,0,1)*v_(1,0,1)*v_(2,2,1) + v_(0,0,2)*v_(1,0,2)*v_(2,2,2)),
    t_(0,0,3) - (v_(0,0,0)*v_(1,0,0)*v_(2,3,0) + v_(0,0,1)*v_(1,0,1)*v_(2,3,1) + v_(0,0,2)*v_(1,0,2)*v_(2,3,2)),
    t_(0,1,0) - (v_(0,0,2)*v_(1,1,2)*v_(2,0,2)),
    t_(0,1,1) - (v_(0,0,2)*v_(1,1,2)*v_(2,1,2)),
    t_(0,1,2) - (v_(0,0,0)*v_(1,1,0)*v_(2,2,0) + v_(0,0,1)*v_(1,1,1)*v_(2,2,1) + v_(0,0,2)*v_(1,1,2)*v_(2,2,2)),
    t_(0,1,3) - (v_(0,0,0)*v_(1,1,0)*v_(2,3,0) + v_(0,0,1)*v_(1,1,1)*v_(2,3,1) + v_(0,0,2)*v_(1,1,2)*v_(2,3,2)),
    t_(0,2,0) - (v_(0,0,2)*v_(1,2,2)*v_(2,0,2)),
    t_(0,2,1) - (v_(0,0,2)*v_(1,2,2)*v_(2,1,2)),
    t_(0,2,2) - (v_(0,0,0)*v_(1,2,0)*v_(2,2,0) + v_(0,0,1)*v_(1,2,1)*v_(2,2,1) + v_(0,0,2)*v_(1,2,2)*v_(2,2,2)),
    t_(0,2,3) - (v_(0,0,0)*v_(1,2,0)*v_(2,3,0) + v_(0,0,1)*v_(1,2,1)*v_(2,3,1) + v_(0,0,2)*v_(1,2,2)*v_(2,3,2)),
    t_(0,3,0) - (v_(0,0,2)*v_(1,3,2)*v_(2,0,2)),
    t_(0,3,1) - (v_(0,0,2)*v_(1,3,2)*v_(2,1,2)),
    t_(0,3,2) - (v_(0,0,0)*v_(1,3,0)*v_(2,2,0) + v_(0,0,1)*v_(1,3,1)*v_(2,2,1) + v_(0,0,2)*v_(1,3,2)*v_(2,2,2)),
    t_(0,3,3) - (v_(0,0,0)*v_(1,3,0)*v_(2,3,0) + v_(0,0,1)*v_(1,3,1)*v_(2,3,1) + v_(0,0,2)*v_(1,3,2)*v_(2,3,2)),
    t_(1,0,0) - (v_(0,1,2)*v_(1,0,2)*v_(2,0,2)),
    t_(1,0,1) - (v_(0,1,2)*v_(1,0,2)*v_(2,1,2)),
    t_(1,0,2) - (v_(0,1,0)*v_(1,0,0)*v_(2,2,0) + v_(0,1,1)*v_(1,0,1)*v_(2,2,1) + v_(0,1,2)*v_(1,0,2)*v_(2,2,2)),
    t_(1,0,3) - (v_(0,1,0)*v_(1,0,0)*v_(2,3,0) + v_(0,1,1)*v_(1,0,1)*v_(2,3,1) + v_(0,1,2)*v_(1,0,2)*v_(2,3,2)),
    t_(1,1,0) - (v_(0,1,2)*v_(1,1,2)*v_(2,0,2)),
    t_(1,1,1) - (v_(0,1,2)*v_(1,1,2)*v_(2,1,2)),
    t_(1,1,2) - (v_(0,1,0)*v_(1,1,0)*v_(2,2,0) + v_(0,1,1)*v_(1,1,1)*v_(2,2,1) + v_(0,1,2)*v_(1,1,2)*v_(2,2,2)),
    t_(1,1,3) - (v_(0,1,0)*v_(1,1,0)*v_(2,3,0) + v_(0,1,1)*v_(1,1,1)*v_(2,3,1) + v_(0,1,2)*v_(1,1,2)*v_(2,3,2)),
    t_(1,2,0) - (v_(0,1,2)*v_(1,2,2)*v_(2,0,2)),
    t_(1,2,1) - (v_(0,1,2)*v_(1,2,2)*v_(2,1,2)),
    t_(1,2,2) - (v_(0,1,0)*v_(1,2,0)*v_(2,2,0) + v_(0,1,1)*v_(1,2,1)*v_(2,2,1) + v_(0,1,2)*v_(1,2,2)*v_(2,2,2)),
    t_(1,2,3) - (v_(0,1,0)*v_(1,2,0)*v_(2,3,0) + v_(0,1,1)*v_(1,2,1)*v_(2,3,1) + v_(0,1,2)*v_(1,2,2)*v_(2,3,2)),
    t_(1,3,0) - (v_(0,1,2)*v_(1,3,2)*v_(2,0,2)),
    t_(1,3,1) - (v_(0,1,2)*v_(1,3,2)*v_(2,1,2)),
    t_(1,3,2) - (v_(0,1,0)*v_(1,3,0)*v_(2,2,0) + v_(0,1,1)*v_(1,3,1)*v_(2,2,1) + v_(0,1,2)*v_(1,3,2)*v_(2,2,2)),
    t_(1,3,3) - (v_(0,1,0)*v_(1,3,0)*v_(2,3,0) + v_(0,1,1)*v_(1,3,1)*v_(2,3,1) + v_(0,1,2)*v_(1,3,2)*v_(2,3,2)),
    t_(2,0,0) - (v_(0,2,2)*v_(1,0,2)*v_(2,0,2)),
    t_(2,0,1) - (v_(0,2,2)*v_(1,0,2)*v_(2,1,2)),
    t_(2,0,2) - (v_(0,2,0)*v_(1,0,0)*v_(2,2,0) + v_(0,2,1)*v_(1,0,1)*v_(2,2,1) + v_(0,2,2)*v_(1,0,2)*v_(2,2,2)),
    t_(2,0,3) - (v_(0,2,0)*v_(1,0,0)*v_(2,3,0) + v_(0,2,1)*v_(1,0,1)*v_(2,3,1) + v_(0,2,2)*v_(1,0,2)*v_(2,3,2)),
    t_(2,1,0) - (v_(0,2,2)*v_(1,1,2)*v_(2,0,2)),
    t_(2,1,1) - (v_(0,2,2)*v_(1,1,2)*v_(2,1,2)),
    t_(2,1,2) - (v_(0,2,0)*v_(1,1,0)*v_(2,2,0) + v_(0,2,1)*v_(1,1,1)*v_(2,2,1) + v_(0,2,2)*v_(1,1,2)*v_(2,2,2)),
    t_(2,1,3) - (v_(0,2,0)*v_(1,1,0)*v_(2,3,0) + v_(0,2,1)*v_(1,1,1)*v_(2,3,1) + v_(0,2,2)*v_(1,1,2)*v_(2,3,2)),
    t_(2,2,0) - (v_(0,2,2)*v_(1,2,2)*v_(2,0,2)),
    t_(2,2,1) - (v_(0,2,2)*v_(1,2,2)*v_(2,1,2)),
    t_(2,2,2) - (v_(0,2,0)*v_(1,2,0)*v_(2,2,0) + v_(0,2,1)*v_(1,2,1)*v_(2,2,1) + v_(0,2,2)*v_(1,2,2)*v_(2,2,2)),
    t_(2,2,3) - (v_(0,2,0)*v_(1,2,0)*v_(2,3,0) + v_(0,2,1)*v_(1,2,1)*v_(2,3,1) + v_(0,2,2)*v_(1,2,2)*v_(2,3,2)),
    t_(2,3,0) - (v_(0,2,2)*v_(1,3,2)*v_(2,0,2)),
    t_(2,3,1) - (v_(0,2,2)*v_(1,3,2)*v_(2,1,2)),
    t_(2,3,2) - (v_(0,2,0)*v_(1,3,0)*v_(2,2,0) + v_(0,2,1)*v_(1,3,1)*v_(2,2,1) + v_(0,2,2)*v_(1,3,2)*v_(2,2,2)),
    t_(2,3,3) - (v_(0,2,0)*v_(1,3,0)*v_(2,3,0) + v_(0,2,1)*v_(1,3,1)*v_(2,3,1) + v_(0,2,2)*v_(1,3,2)*v_(2,3,2)),
    t_(3,0,0) - (v_(0,3,2)*v_(1,0,2)*v_(2,0,2)),
    t_(3,0,1) - (v_(0,3,2)*v_(1,0,2)*v_(2,1,2)),
    t_(3,0,2) - (v_(0,3,0)*v_(1,0,0)*v_(2,2,0) + v_(0,3,1)*v_(1,0,1)*v_(2,2,1) + v_(0,3,2)*v_(1,0,2)*v_(2,2,2)),
    t_(3,0,3) - (v_(0,3,0)*v_(1,0,0)*v_(2,3,0) + v_(0,3,1)*v_(1,0,1)*v_(2,3,1) + v_(0,3,2)*v_(1,0,2)*v_(2,3,2)),
    t_(3,1,0) - (v_(0,3,2)*v_(1,1,2)*v_(2,0,2)),
    t_(3,1,1) - (v_(0,3,2)*v_(1,1,2)*v_(2,1,2)),
    t_(3,1,2) - (v_(0,3,0)*v_(1,1,0)*v_(2,2,0) + v_(0,3,1)*v_(1,1,1)*v_(2,2,1) + v_(0,3,2)*v_(1,1,2)*v_(2,2,2)),
    t_(3,1,3) - (v_(0,3,0)*v_(1,1,0)*v_(2,3,0) + v_(0,3,1)*v_(1,1,1)*v_(2,3,1) + v_(0,3,2)*v_(1,1,2)*v_(2,3,2)),
    t_(3,2,0) - (v_(0,3,2)*v_(1,2,2)*v_(2,0,2)),
    t_(3,2,1) - (v_(0,3,2)*v_(1,2,2)*v_(2,1,2)),
    t_(3,2,2) - (v_(0,3,0)*v_(1,2,0)*v_(2,2,0) + v_(0,3,1)*v_(1,2,1)*v_(2,2,1) + v_(0,3,2)*v_(1,2,2)*v_(2,2,2)),
    t_(3,2,3) - (v_(0,3,0)*v_(1,2,0)*v_(2,3,0) + v_(0,3,1)*v_(1,2,1)*v_(2,3,1) + v_(0,3,2)*v_(1,2,2)*v_(2,3,2)),
    t_(3,3,0) - (v_(0,3,2)*v_(1,3,2)*v_(2,0,2)),
    t_(3,3,1) - (v_(0,3,2)*v_(1,3,2)*v_(2,1,2)),
    t_(3,3,2) - (v_(0,3,0)*v_(1,3,0)*v_(2,2,0) + v_(0,3,1)*v_(1,3,1)*v_(2,2,1) + v_(0,3,2)*v_(1,3,2)*v_(2,2,2)),
    t_(3,3,3) - (v_(0,3,0)*v_(1,3,0)*v_(2,3,0) + v_(0,3,1)*v_(1,3,1)*v_(2,3,1) + v_(0,3,2)*v_(1,3,2)*v_(2,3,2))
)

-- Constructing all 2D Slices for an N-way tensor
S_0_1_fixed_0 = matrix{
    {t_(0,0,0), t_(0,1,0), t_(0,2,0), t_(0,3,0)},
    {t_(1,0,0), t_(1,1,0), t_(1,2,0), t_(1,3,0)},
    {t_(2,0,0), t_(2,1,0), t_(2,2,0), t_(2,3,0)},
    {t_(3,0,0), t_(3,1,0), t_(3,2,0), t_(3,3,0)}
}
S_0_1_fixed_1 = matrix{
    {t_(0,0,1), t_(0,1,1), t_(0,2,1), t_(0,3,1)},
    {t_(1,0,1), t_(1,1,1), t_(1,2,1), t_(1,3,1)},
    {t_(2,0,1), t_(2,1,1), t_(2,2,1), t_(2,3,1)},
    {t_(3,0,1), t_(3,1,1), t_(3,2,1), t_(3,3,1)}
}
S_0_1_fixed_2 = matrix{
    {t_(0,0,2), t_(0,1,2), t_(0,2,2), t_(0,3,2)},
    {t_(1,0,2), t_(1,1,2), t_(1,2,2), t_(1,3,2)},
    {t_(2,0,2), t_(2,1,2), t_(2,2,2), t_(2,3,2)},
    {t_(3,0,2), t_(3,1,2), t_(3,2,2), t_(3,3,2)}
}
S_0_1_fixed_3 = matrix{
    {t_(0,0,3), t_(0,1,3), t_(0,2,3), t_(0,3,3)},
    {t_(1,0,3), t_(1,1,3), t_(1,2,3), t_(1,3,3)},
    {t_(2,0,3), t_(2,1,3), t_(2,2,3), t_(2,3,3)},
    {t_(3,0,3), t_(3,1,3), t_(3,2,3), t_(3,3,3)}
}
S_0_2_fixed_0 = matrix{
    {t_(0,0,0), t_(0,0,1), t_(0,0,2), t_(0,0,3)},
    {t_(1,0,0), t_(1,0,1), t_(1,0,2), t_(1,0,3)},
    {t_(2,0,0), t_(2,0,1), t_(2,0,2), t_(2,0,3)},
    {t_(3,0,0), t_(3,0,1), t_(3,0,2), t_(3,0,3)}
}
S_0_2_fixed_1 = matrix{
    {t_(0,1,0), t_(0,1,1), t_(0,1,2), t_(0,1,3)},
    {t_(1,1,0), t_(1,1,1), t_(1,1,2), t_(1,1,3)},
    {t_(2,1,0), t_(2,1,1), t_(2,1,2), t_(2,1,3)},
    {t_(3,1,0), t_(3,1,1), t_(3,1,2), t_(3,1,3)}
}
S_0_2_fixed_2 = matrix{
    {t_(0,2,0), t_(0,2,1), t_(0,2,2), t_(0,2,3)},
    {t_(1,2,0), t_(1,2,1), t_(1,2,2), t_(1,2,3)},
    {t_(2,2,0), t_(2,2,1), t_(2,2,2), t_(2,2,3)},
    {t_(3,2,0), t_(3,2,1), t_(3,2,2), t_(3,2,3)}
}
S_0_2_fixed_3 = matrix{
    {t_(0,3,0), t_(0,3,1), t_(0,3,2), t_(0,3,3)},
    {t_(1,3,0), t_(1,3,1), t_(1,3,2), t_(1,3,3)},
    {t_(2,3,0), t_(2,3,1), t_(2,3,2), t_(2,3,3)},
    {t_(3,3,0), t_(3,3,1), t_(3,3,2), t_(3,3,3)}
}
S_1_2_fixed_0 = matrix{
    {t_(0,0,0), t_(0,0,1), t_(0,0,2), t_(0,0,3)},
    {t_(0,1,0), t_(0,1,1), t_(0,1,2), t_(0,1,3)},
    {t_(0,2,0), t_(0,2,1), t_(0,2,2), t_(0,2,3)},
    {t_(0,3,0), t_(0,3,1), t_(0,3,2), t_(0,3,3)}
}
S_1_2_fixed_1 = matrix{
    {t_(1,0,0), t_(1,0,1), t_(1,0,2), t_(1,0,3)},
    {t_(1,1,0), t_(1,1,1), t_(1,1,2), t_(1,1,3)},
    {t_(1,2,0), t_(1,2,1), t_(1,2,2), t_(1,2,3)},
    {t_(1,3,0), t_(1,3,1), t_(1,3,2), t_(1,3,3)}
}
S_1_2_fixed_2 = matrix{
    {t_(2,0,0), t_(2,0,1), t_(2,0,2), t_(2,0,3)},
    {t_(2,1,0), t_(2,1,1), t_(2,1,2), t_(2,1,3)},
    {t_(2,2,0), t_(2,2,1), t_(2,2,2), t_(2,2,3)},
    {t_(2,3,0), t_(2,3,1), t_(2,3,2), t_(2,3,3)}
}
S_1_2_fixed_3 = matrix{
    {t_(3,0,0), t_(3,0,1), t_(3,0,2), t_(3,0,3)},
    {t_(3,1,0), t_(3,1,1), t_(3,1,2), t_(3,1,3)},
    {t_(3,2,0), t_(3,2,1), t_(3,2,2), t_(3,2,3)},
    {t_(3,3,0), t_(3,3,1), t_(3,3,2), t_(3,3,3)}
}

3x3 minors of all 2D slices
sliceIdeal = minors(3, S_0_1_fixed_0) + minors(3, S_0_1_fixed_1) + minors(3, S_0_1_fixed_2) + minors(3, S_0_1_fixed_3) + minors(3, S_0_2_fixed_0) + minors(3, S_0_2_fixed_1) + minors(3, S_0_2_fixed_2) + minors(3, S_0_2_fixed_3) + minors(3, S_1_2_fixed_0) + minors(3, S_1_2_fixed_1) + minors(3, S_1_2_fixed_2) + minors(3, S_1_2_fixed_3)

-- Implicit equations by elimination
factorVars = {v_(0,0,0), v_(0,0,1), v_(0,0,2), v_(0,1,0), v_(0,1,1), v_(0,1,2), v_(0,2,0), v_(0,2,1), v_(0,2,2), v_(0,3,0), v_(0,3,1), v_(0,3,2), v_(1,0,0), v_(1,0,1), v_(1,0,2), v_(1,1,0), v_(1,1,1), v_(1,1,2), v_(1,2,0), v_(1,2,1), v_(1,2,2), v_(1,3,0), v_(1,3,1), v_(1,3,2), v_(2,0,2), v_(2,1,2), v_(2,2,0), v_(2,2,1), v_(2,2,2), v_(2,3,0), v_(2,3,1), v_(2,3,2)}
J = eliminate(factorVars, I_cp + sliceIdeal)

print "--- Betti Table of the Generators ---"
print net betti gens J

